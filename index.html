<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Eventos - Arena BRB</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #023E7C 0%, #0E76E0 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .header h1 {
            color: #023E7C;
            font-size: 28px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-container {
            background: linear-gradient(135deg, #023E7C 0%, #0E76E0 100%);
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .logo-container img {
            height: 40px;
            width: auto;
        }

        .header-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #023E7C 0%, #0E76E0 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(2, 62, 124, 0.4);
        }

        .btn-secondary {
            background: #48bb78;
            color: white;
        }

        .btn-secondary:hover {
            background: #38a169;
            transform: translateY(-2px);
        }

        .connection-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }

        .connection-status.online {
            background: #c6f6d5;
            color: #22543d;
        }

        .connection-status.offline {
            background: #fed7d7;
            color: #742a2a;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-dot.online {
            background: #48bb78;
        }

        .status-dot.offline {
            background: #f56565;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .events-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .event-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .event-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #023E7C 0%, #0E76E0 100%);
        }

        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .event-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }

        .event-title {
            color: #2d3748;
            font-size: 20px;
            font-weight: bold;
            flex: 1;
        }

        .event-actions {
            display: flex;
            gap: 8px;
        }

        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 18px;
            padding: 5px;
            transition: all 0.2s;
            border-radius: 5px;
        }

        .icon-btn:hover {
            background: #f7fafc;
            transform: scale(1.1);
        }

        .event-info {
            margin-bottom: 12px;
            display: flex;
            align-items: start;
            gap: 10px;
        }

        .info-icon {
            margin-top: 2px;
            font-size: 16px;
        }

        .info-label {
            font-weight: 600;
            color: #4a5568;
            min-width: 80px;
        }

        .info-value {
            color: #2d3748;
            flex: 1;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin: 2px;
        }

        .badge-success {
            background: #c6f6d5;
            color: #22543d;
        }

        .badge-warning {
            background: #feebc8;
            color: #7c2d12;
        }

        .badge-info {
            background: #bee3f8;
            color: #2c5282;
        }

        .checkout-section {
            margin-top: 15px;
            padding: 12px;
            background: #f7fafc;
            border-radius: 8px;
            border: 2px dashed #cbd5e0;
        }

        .checkout-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .checkout-title {
            font-weight: 600;
            color: #4a5568;
            font-size: 14px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: background 0.2s;
        }

        .checkbox-label:hover {
            background: #edf2f7;
        }

        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkout-validated {
            background: #c6f6d5;
            border-color: #48bb78;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 24px;
            color: #2d3748;
            font-weight: bold;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #718096;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: #f7fafc;
            color: #2d3748;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
            font-size: 14px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: #0E76E0;
            box-shadow: 0 0 0 3px rgba(14, 118, 224, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .empty-state-text {
            color: #718096;
            font-size: 18px;
            margin-bottom: 20px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 2000;
            display: none;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s ease;
        }

        .notification.show {
            display: flex;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification-success {
            border-left: 4px solid #48bb78;
        }

        .tabs-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 24px;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: #4a5568;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            border-color: #0E76E0;
            color: #023E7C;
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #023E7C 0%, #0E76E0 100%);
            color: white;
            border-color: #023E7C;
        }

        .tab-count {
            background: rgba(255,255,255,0.3);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 13px;
            min-width: 24px;
            text-align: center;
        }

        .tab-btn.active .tab-count {
            background: rgba(255,255,255,0.2);
        }

        .completed-badge {
            background: #48bb78;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .event-card.completed {
            opacity: 0.85;
        }

        .event-card.completed::before {
            background: linear-gradient(90deg, #48bb78 0%, #38a169 100%);
        }

        .completion-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            background: #f7fafc;
            border-radius: 8px;
            margin-top: 15px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid #e2e8f0;
        }

        .completion-checkbox:hover {
            background: #edf2f7;
            border-color: #cbd5e0;
        }

        .completion-checkbox.checked {
            background: #c6f6d5;
            border-color: #48bb78;
        }

        .completion-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
        }

        .completion-label {
            font-weight: 600;
            color: #2d3748;
            flex: 1;
        }

        @media (max-width: 768px) {
            .events-grid {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                align-items: stretch;
            }

            .header > div:first-child {
                justify-content: center;
            }

            .header h1 {
                font-size: 22px;
                text-align: center;
            }

            .logo-container {
                margin: 0 auto;
            }

            .header-buttons {
                flex-direction: column;
            }

            .tabs {
                flex-direction: column;
            }

            .tab-btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div style="display: flex; align-items: center; gap: 20px; flex-wrap: wrap;">
                <div class="logo-container">
                    <img src="https://arenabsb.com.br/wp-content/uploads/2023/05/logo-header-arena-brb.svg" alt="Arena BRB">
                </div>
                <h1>Dashboard de Eventos</h1>
            </div>
            <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                <div class="connection-status online" id="connectionStatus">
                    <div class="status-dot online" id="statusDot"></div>
                    <span id="statusText">Conectado</span>
                </div>
                <div class="header-buttons">
                    <button class="btn btn-primary" id="addEventBtn">
                        <span>‚ûï</span> Adicionar Evento
                    </button>
                </div>
            </div>
        </div>

        <div class="tabs-container">
            <div class="tabs">
                <button class="tab-btn active" id="activeTab">
                    üìÖ Eventos Ativos <span class="tab-count" id="activeCount">0</span>
                </button>
                <button class="tab-btn" id="completedTab">
                    ‚úÖ Eventos Conclu√≠dos <span class="tab-count" id="completedCount">0</span>
                </button>
            </div>
        </div>

        <div id="eventsContainer" class="events-grid"></div>
        <div id="emptyState" class="empty-state" style="display: none;">
            <div class="empty-state-icon">üìÖ</div>
            <div class="empty-state-text">Nenhum evento cadastrado ainda</div>
            <button class="btn btn-primary" id="addEventBtnEmpty">
                <span>‚ûï</span> Adicionar Primeiro Evento
            </button>
        </div>
    </div>

    <div id="eventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Adicionar Evento</h2>
                <button class="close-btn" id="closeModalBtn">√ó</button>
            </div>
            <form id="eventForm">
                <div class="form-group">
                    <label class="form-label">Nome do Evento *</label>
                    <input type="text" class="form-input" id="eventName" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Data do Evento *</label>
                    <input type="date" class="form-input" id="eventDate" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Data da Montagem</label>
                    <input type="date" class="form-input" id="setupDate">
                </div>

                <div class="form-group">
                    <label class="form-label">Hor√°rio de In√≠cio</label>
                    <input type="time" class="form-input" id="eventTime">
                </div>

                <div class="form-group">
                    <label class="form-label">Hor√°rio de T√©rmino</label>
                    <input type="time" class="form-input" id="eventEndTime">
                </div>

                <div class="form-group">
                    <label class="form-label">Local *</label>
                    <input type="text" class="form-input" id="eventLocation" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Prestador de Servi√ßo de Internet *</label>
                    <select class="form-select" id="internetProvider" required>
                        <option value="">Selecione...</option>
                        <option value="Engefire">Engefire</option>
                        <option value="Conectar">Conectar</option>
                        <option value="Hardteck">Hardteck</option>
                        <option value="Starlink">Starlink</option>
                        <option value="Internet B√°sica">Internet B√°sica</option>
                        <option value="Sem Internet">Sem Internet</option>
                        <option value="Outro">Outro</option>
                    </select>
                </div>

                <div class="form-group" id="otherProviderGroup" style="display: none;">
                    <label class="form-label">Especificar Prestador</label>
                    <input type="text" class="form-input" id="otherProvider">
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="isExternalProvider">
                        <span>Fornecedor √© Externo</span>
                    </label>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="usesScreen">
                        <span>Utilizar√° Tel√£o</span>
                    </label>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="usesTurnstiles">
                        <span>Utilizar√° Catracas</span>
                    </label>
                </div>

                <div class="form-group" id="turnstileGroup" style="display: none;">
                    <label class="form-label">Port√µes das Catracas</label>
                    <input type="text" class="form-input" id="turnstileGates" placeholder="Ex: G11, F14, F17, K5">
                </div>

                <div class="form-group">
                    <label class="form-label">Ticketeira / Sistema de Ingressos</label>
                    <input type="text" class="form-input" id="ticketSystem" placeholder="Ex: Ingresse, Sympla, etc">
                </div>

                <div class="form-group">
                    <label class="form-label">Port√µes de Entrada</label>
                    <input type="text" class="form-input" id="entranceGates" placeholder="Ex: A4, A5">
                </div>

                <div class="form-group">
                    <label class="form-label">Capacidade de P√∫blico</label>
                    <input type="text" class="form-input" id="capacity" placeholder="Ex: 200 pessoas">
                </div>

                <div class="form-group">
                    <label class="form-label">Observa√ß√µes Adicionais</label>
                    <textarea class="form-textarea" id="notes" placeholder="Informa√ß√µes extras sobre o evento"></textarea>
                </div>

                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 25px;">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="submitBtn">
                        <span id="submitBtnText">‚ûï Adicionar</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="notification" class="notification">
        <span id="notificationIcon"></span>
        <span id="notificationText"></span>
    </div>

    <script>
        // ============================================
        // CONFIGURA√á√ÉO DO FIREBASE
        // ============================================
        // SUBSTITUA ESTAS INFORMA√á√ïES PELAS SUAS AP√ìS CRIAR O PROJETO NO FIREBASE!
        const firebaseConfig = {
            apiKey: "AIzaSyDxJFUYEM5zeYXMXoNU49IZXyQ5-3ZbLIo",
            authDomain: "arena-brb-dashboard.firebaseapp.com",
            databaseURL: "https://arena-brb-dashboard-default-rtdb.firebaseio.com",
            projectId: "arena-brb-dashboard",
            storageBucket: "arena-brb-dashboard.firebasestorage.app",
            messagingSenderId: "1023617101570",
            appId: "1:1023617101570:web:cdeba00f27a10073c85c1b"

        };

        // Inicializar Firebase
        let database;
        let eventsRef;
        let isFirebaseConfigured = false;
        
        try {
            // Verificar se a configura√ß√£o foi alterada
            if (firebaseConfig.apiKey !== "SUA_API_KEY_AQUI") {
                firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                eventsRef = database.ref('events');
                isFirebaseConfigured = true;
                console.log('‚úÖ Firebase conectado com sucesso!');
                
                // Monitorar status da conex√£o
                database.ref('.info/connected').on('value', function(snapshot) {
                    if (snapshot.val() === true) {
                        updateConnectionStatus(true);
                    } else {
                        updateConnectionStatus(false);
                    }
                });
            } else {
                console.warn('‚ö†Ô∏è Configure o Firebase! Veja as instru√ß√µes no arquivo INSTRU√á√ïES_FIREBASE.txt');
                showNotification('Configure o Firebase para sincronizar dados entre usu√°rios!', 'warning');
            }
        } catch (error) {
            console.error('‚ùå Erro ao conectar Firebase:', error);
            isFirebaseConfigured = false;
        }

        function updateConnectionStatus(isOnline) {
            const statusEl = document.getElementById('connectionStatus');
            const dotEl = document.getElementById('statusDot');
            const textEl = document.getElementById('statusText');
            
            if (isOnline) {
                statusEl.className = 'connection-status online';
                dotEl.className = 'status-dot online';
                textEl.textContent = 'Conectado';
            } else {
                statusEl.className = 'connection-status offline';
                dotEl.className = 'status-dot offline';
                textEl.textContent = 'Desconectado';
            }
        }

        // ============================================
        // C√ìDIGO DO APLICATIVO
        // ============================================
        let events = [];
        let editingIndex = -1;
        let currentTab = 'active';

        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            setupEventListeners();
            
            if (isFirebaseConfigured) {
                loadDataFromFirebase();
            } else {
                // Fallback para localStorage se Firebase n√£o configurado
                loadDataFromLocalStorage();
                updateConnectionStatus(false);
            }
        }

        function setupEventListeners() {
            document.getElementById('addEventBtn').addEventListener('click', openAddEventModal);
            document.getElementById('addEventBtnEmpty').addEventListener('click', openAddEventModal);

            document.getElementById('activeTab').addEventListener('click', function() {
                switchTab('active');
            });
            document.getElementById('completedTab').addEventListener('click', function() {
                switchTab('completed');
            });

            document.getElementById('closeModalBtn').addEventListener('click', closeEventModal);
            document.getElementById('cancelBtn').addEventListener('click', closeEventModal);
            document.getElementById('eventModal').addEventListener('click', function(e) {
                if (e.target.id === 'eventModal') {
                    closeEventModal();
                }
            });

            document.getElementById('eventForm').addEventListener('submit', handleFormSubmit);
            document.getElementById('internetProvider').addEventListener('change', handleProviderChange);
            document.getElementById('usesTurnstiles').addEventListener('change', handleTurnstilesChange);
        }

        function loadDataFromFirebase() {
            // Listener em tempo real - sincroniza automaticamente com todos os usu√°rios
            eventsRef.on('value', function(snapshot) {
                const data = snapshot.val();
                if (data && Array.isArray(data)) {
                    events = data;
                    renderEvents();
                } else if (data === null) {
                    // Primeira vez - carregar eventos iniciais
                    loadInitialEvents();
                } else {
                    events = [];
                    renderEvents();
                }
            }, function(error) {
                console.error('Erro ao carregar dados:', error);
                showNotification('Erro ao carregar eventos do Firebase', 'error');
            });
        }

        function loadDataFromLocalStorage() {
            const savedData = localStorage.getItem('arenaEvents');
            if (savedData) {
                events = JSON.parse(savedData);
                renderEvents();
            } else {
                loadInitialEvents();
            }
        }

        function saveData() {
            if (isFirebaseConfigured) {
                // Salvar no Firebase (sincroniza com todos)
                eventsRef.set(events)
                    .then(function() {
                        console.log('‚úÖ Dados salvos no Firebase');
                    })
                    .catch(function(error) {
                        console.error('‚ùå Erro ao salvar:', error);
                        showNotification('Erro ao salvar no Firebase', 'error');
                    });
            } else {
                // Fallback para localStorage
                localStorage.setItem('arenaEvents', JSON.stringify(events));
                console.log('üíæ Dados salvos localmente (configure Firebase para sincronizar)');
            }
        }

        function switchTab(tab) {
            currentTab = tab;
            
            document.getElementById('activeTab').classList.toggle('active', tab === 'active');
            document.getElementById('completedTab').classList.toggle('active', tab === 'completed');
            
            renderEvents();
        }

        function handleFormSubmit(e) {
            e.preventDefault();

            const eventData = {
                name: document.getElementById('eventName').value,
                date: document.getElementById('eventDate').value,
                setupDate: document.getElementById('setupDate').value,
                time: document.getElementById('eventTime').value,
                endTime: document.getElementById('eventEndTime').value,
                location: document.getElementById('eventLocation').value,
                internetProvider: document.getElementById('internetProvider').value === 'Outro' 
                    ? document.getElementById('otherProvider').value 
                    : document.getElementById('internetProvider').value,
                isExternal: document.getElementById('isExternalProvider').checked,
                checkoutValidated: false,
                usesScreen: document.getElementById('usesScreen').checked,
                usesTurnstiles: document.getElementById('usesTurnstiles').checked,
                turnstileGates: document.getElementById('turnstileGates').value,
                ticketSystem: document.getElementById('ticketSystem').value,
                entranceGates: document.getElementById('entranceGates').value,
                capacity: document.getElementById('capacity').value,
                notes: document.getElementById('notes').value,
                completed: false
            };

            if (editingIndex >= 0) {
                eventData.checkoutValidated = events[editingIndex].checkoutValidated || false;
                eventData.completed = events[editingIndex].completed || false;
                events[editingIndex] = eventData;
                showNotification('Evento atualizado com sucesso!', 'success');
            } else {
                events.push(eventData);
                showNotification('Evento adicionado com sucesso!', 'success');
            }

            saveData();
            closeEventModal();
            renderEvents();
        }

        function handleProviderChange() {
            const otherGroup = document.getElementById('otherProviderGroup');
            otherGroup.style.display = this.value === 'Outro' ? 'block' : 'none';
        }

        function handleTurnstilesChange() {
            const turnstileGroup = document.getElementById('turnstileGroup');
            turnstileGroup.style.display = this.checked ? 'block' : 'none';
        }

        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            const icon = document.getElementById('notificationIcon');
            const text = document.getElementById('notificationText');

            icon.textContent = type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ùå';
            text.textContent = message;
            notification.className = 'notification notification-' + type + ' show';

            setTimeout(function() {
                notification.classList.remove('show');
            }, 4000);
        }

        function openAddEventModal() {
            editingIndex = -1;
            document.getElementById('modalTitle').textContent = 'Adicionar Evento';
            document.getElementById('submitBtnText').innerHTML = '‚ûï Adicionar';
            document.getElementById('eventForm').reset();
            document.getElementById('otherProviderGroup').style.display = 'none';
            document.getElementById('turnstileGroup').style.display = 'none';
            document.getElementById('eventModal').classList.add('active');
        }

        function closeEventModal() {
            document.getElementById('eventModal').classList.remove('active');
            editingIndex = -1;
        }

        function renderEvents() {
            const container = document.getElementById('eventsContainer');
            const emptyState = document.getElementById('emptyState');

            const filteredEvents = events.filter(function(event) {
                if (currentTab === 'active') {
                    return !event.completed;
                } else {
                    return event.completed;
                }
            });

            const activeCount = events.filter(e => !e.completed).length;
            const completedCount = events.filter(e => e.completed).length;
            document.getElementById('activeCount').textContent = activeCount;
            document.getElementById('completedCount').textContent = completedCount;

            if (filteredEvents.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                if (currentTab === 'completed') {
                    document.querySelector('.empty-state-text').textContent = 'Nenhum evento conclu√≠do ainda';
                } else {
                    document.querySelector('.empty-state-text').textContent = 'Nenhum evento ativo cadastrado';
                }
                return;
            }

            emptyState.style.display = 'none';

            const sortedEvents = filteredEvents.slice().sort(function(a, b) {
                return new Date(a.date) - new Date(b.date);
            });

            container.innerHTML = sortedEvents.map(function(event) {
                const originalIndex = events.indexOf(event);
                const eventDate = new Date(event.date + 'T00:00:00');
                const formattedDate = eventDate.toLocaleDateString('pt-BR');
                const setupDate = event.setupDate ? new Date(event.setupDate + 'T00:00:00').toLocaleDateString('pt-BR') : '-';

                let html = '<div class="event-card' + (event.completed ? ' completed' : '') + '">';
                html += '<div class="event-header">';
                html += '<div class="event-title">' + event.name + '</div>';
                html += '<div class="event-actions">';
                html += '<button class="icon-btn" onclick="editEvent(' + originalIndex + ')" title="Editar">‚úèÔ∏è</button>';
                html += '<button class="icon-btn" onclick="deleteEvent(' + originalIndex + ')" title="Excluir">üóëÔ∏è</button>';
                html += '</div></div>';

                html += '<div class="event-info"><span class="info-icon">üìÖ</span><span class="info-label">Data:</span><span class="info-value">' + formattedDate + '</span></div>';

                if (event.time) {
                    html += '<div class="event-info"><span class="info-icon">üïê</span><span class="info-label">Hor√°rio:</span><span class="info-value">' + event.time;
                    if (event.endTime) html += ' - ' + event.endTime;
                    html += '</span></div>';
                }

                if (event.setupDate) {
                    html += '<div class="event-info"><span class="info-icon">üîß</span><span class="info-label">Montagem:</span><span class="info-value">' + setupDate + '</span></div>';
                }

                html += '<div class="event-info"><span class="info-icon">üìç</span><span class="info-label">Local:</span><span class="info-value">' + event.location + '</span></div>';
                html += '<div class="event-info"><span class="info-icon">üåê</span><span class="info-label">Internet:</span><span class="info-value">' + event.internetProvider + '</span></div>';

                if (event.capacity) {
                    html += '<div class="event-info"><span class="info-icon">üë•</span><span class="info-label">Capacidade:</span><span class="info-value">' + event.capacity + '</span></div>';
                }

                html += '<div style="margin-top: 12px; display: flex; flex-wrap: wrap; gap: 5px;">';
                if (event.usesScreen) html += '<span class="badge badge-info">üì∫ Tel√£o</span>';
                if (event.usesTurnstiles) html += '<span class="badge badge-info">üö™ Catracas</span>';
                if (event.isExternal) html += '<span class="badge badge-warning">‚ö†Ô∏è Fornecedor Externo</span>';
                if (event.completed) html += '<span class="completed-badge">‚úì Conclu√≠do</span>';
                html += '</div>';

                if (event.usesTurnstiles && event.turnstileGates) {
                    html += '<div class="event-info" style="margin-top: 10px;"><span class="info-icon">üö™</span><span class="info-label">Port√µes:</span><span class="info-value">' + event.turnstileGates + '</span></div>';
                }

                if (event.entranceGates) {
                    html += '<div class="event-info"><span class="info-icon">üö∂</span><span class="info-label">Entrada:</span><span class="info-value">' + event.entranceGates + '</span></div>';
                }

                if (event.ticketSystem) {
                    html += '<div class="event-info"><span class="info-icon">üé´</span><span class="info-label">Ticketeira:</span><span class="info-value">' + event.ticketSystem + '</span></div>';
                }

                if (event.notes) {
                    html += '<div class="event-info" style="margin-top: 10px;"><span class="info-icon">üìù</span><span class="info-label">Obs:</span><span class="info-value">' + event.notes + '</span></div>';
                }

                if (event.isExternal) {
                    html += '<div class="checkout-section ' + (event.checkoutValidated ? 'checkout-validated' : '') + '">';
                    html += '<div class="checkout-header"><span class="checkout-title">Valida√ß√£o de Checkout</span></div>';
                    html += '<label class="checkbox-label">';
                    html += '<input type="checkbox" ' + (event.checkoutValidated ? 'checked' : '') + ' onchange="toggleCheckout(' + originalIndex + ')">';
                    html += '<span>Remo√ß√£o de fibra validada ‚úì</span>';
                    html += '</label></div>';
                }

                html += '<div class="completion-checkbox ' + (event.completed ? 'checked' : '') + '" onclick="toggleCompletion(' + originalIndex + ')">';
                html += '<input type="checkbox" ' + (event.completed ? 'checked' : '') + ' onclick="event.stopPropagation();">';
                html += '<span class="completion-label">' + (event.completed ? 'Evento Conclu√≠do' : 'Marcar como Conclu√≠do') + '</span>';
                html += '</div>';

                html += '</div>';
                return html;
            }).join('');
        }

        function toggleCheckout(index) {
            events[index].checkoutValidated = !events[index].checkoutValidated;
            saveData();
            renderEvents();
            showNotification('Status de checkout atualizado!', 'success');
        }

        function toggleCompletion(index) {
            events[index].completed = !events[index].completed;
            saveData();
            
            if (events[index].completed) {
                showNotification('Evento marcado como conclu√≠do!', 'success');
                setTimeout(function() {
                    switchTab('completed');
                }, 1000);
            } else {
                showNotification('Evento reativado!', 'success');
                setTimeout(function() {
                    switchTab('active');
                }, 1000);
            }
            
            renderEvents();
        }

        function editEvent(index) {
            editingIndex = index;
            const event = events[index];

            document.getElementById('modalTitle').textContent = 'Editar Evento';
            document.getElementById('submitBtnText').innerHTML = 'üíæ Salvar';
            
            document.getElementById('eventName').value = event.name;
            document.getElementById('eventDate').value = event.date;
            document.getElementById('setupDate').value = event.setupDate || '';
            document.getElementById('eventTime').value = event.time || '';
            document.getElementById('eventEndTime').value = event.endTime || '';
            document.getElementById('eventLocation').value = event.location;
            
            const providerSelect = document.getElementById('internetProvider');
            const standardProviders = ['Conectar', 'Engefire', 'Starlink', 'Internet B√°sica', 'Sem Internet'];
            if (standardProviders.indexOf(event.internetProvider) !== -1) {
                providerSelect.value = event.internetProvider;
            } else {
                providerSelect.value = 'Outro';
                document.getElementById('otherProviderGroup').style.display = 'block';
                document.getElementById('otherProvider').value = event.internetProvider;
            }

            document.getElementById('isExternalProvider').checked = event.isExternal;
            document.getElementById('usesScreen').checked = event.usesScreen;
            document.getElementById('usesTurnstiles').checked = event.usesTurnstiles;
            document.getElementById('turnstileGates').value = event.turnstileGates || '';
            document.getElementById('ticketSystem').value = event.ticketSystem || '';
            document.getElementById('entranceGates').value = event.entranceGates || '';
            document.getElementById('capacity').value = event.capacity || '';
            document.getElementById('notes').value = event.notes || '';

            if (event.usesTurnstiles) {
                document.getElementById('turnstileGroup').style.display = 'block';
            }

            document.getElementById('eventModal').classList.add('active');
        }

        function deleteEvent(index) {
            if (confirm('Tem certeza que deseja excluir este evento?')) {
                events.splice(index, 1);
                saveData();
                renderEvents();
                showNotification('Evento exclu√≠do com sucesso!', 'success');
            }
        }

        function loadInitialEvents() {
            events = [
                {
                    name: "Sicoob",
                    date: "2025-12-13",
                    setupDate: "",
                    time: "",
                    endTime: "",
                    location: "Areninha Sul",
                    internetProvider: "Conectar",
                    isExternal: false,
                    checkoutValidated: false,
                    usesScreen: false,
                    usesTurnstiles: false,
                    turnstileGates: "",
                    ticketSystem: "",
                    entranceGates: "",
                    capacity: "",
                    notes: "",
                    completed: false
                },
                {
                    name: "Premia√ß√£o Lixo Zero",
                    date: "2025-12-03",
                    setupDate: "",
                    time: "19:00",
                    endTime: "",
                    location: "Cobogo",
                    internetProvider: "Sem Internet",
                    isExternal: false,
                    checkoutValidated: false,
                    usesScreen: false,
                    usesTurnstiles: true,
                    turnstileGates: "Esfera - 2 primeiras catracas",
                    ticketSystem: "",
                    entranceGates: "",
                    capacity: "",
                    notes: "Abaixar as duas primeiras catracas do esfera",
                    completed: false
                },
                {
                    name: "Incendi√°rios",
                    date: "2025-12-09",
                    setupDate: "2025-12-08",
                    time: "",
                    endTime: "",
                    location: "GNN",
                    internetProvider: "Engefire",
                    isExternal: false,
                    checkoutValidated: false,
                    usesScreen: true,
                    usesTurnstiles: false,
                    turnstileGates: "",
                    ticketSystem: "",
                    entranceGates: "",
                    capacity: "",
                    notes: "Tel√£o - testes dia 08/12. Rodrigo ficou de enviar hor√°rio e receber nome do prestador",
                    completed: false
                },
                {
                    name: "Banco do Brasil",
                    date: "2025-12-04",
                    setupDate: "",
                    time: "14:00",
                    endTime: "00:00",
                    location: "Tribuna de Honra e Modesto",
                    internetProvider: "Internet B√°sica",
                    isExternal: false,
                    checkoutValidated: false,
                    usesScreen: false,
                    usesTurnstiles: true,
                    turnstileGates: "Esfera - 2 primeiras catracas",
                    ticketSystem: "",
                    entranceGates: "",
                    capacity: "Tribuna: 200 pessoas, Modesto: 400 pessoas",
                    notes: "Internet na tribuna ir√£o usar a b√°sica. Abaixar as duas primeiras catracas do esfera",
                    completed: false
                },
                {
                    name: "Bras√≠lia Drift Kings",
                    date: "2025-12-05",
                    setupDate: "2025-12-02",
                    time: "10:00",
                    endTime: "22:00",
                    location: "Estacionamento Leste",
                    internetProvider: "Starlink",
                    isExternal: false,
                    checkoutValidated: false,
                    usesScreen: false,
                    usesTurnstiles: false,
                    turnstileGates: "",
                    ticketSystem: "",
                    entranceGates: "P√∫blico: A4, Produ√ß√£o: A5",
                    capacity: "",
                    notes: "Evento de 05/12 a 07/12. Montagem in√≠cio dia 02. Entrada p√∫blico das 10h √†s 22h",
                    completed: false
                },
                {
                    name: "Sorriso Maroto",
                    date: "2025-12-07",
                    setupDate: "",
                    time: "20:00",
                    endTime: "",
                    location: "Arena Principal",
                    internetProvider: "Engefire",
                    isExternal: true,
                    checkoutValidated: false,
                    usesScreen: false,
                    usesTurnstiles: true,
                    turnstileGates: "G11, F14, F17, K5",
                    ticketSystem: "Ingresse",
                    entranceGates: "G11, F14, F17, K5",
                    capacity: "",
                    notes: "Bilheteria entre port√£o E e F. Abertura dos port√µes 18h. Usar√£o catracas para leitura de ingresso. Internet a negociar com Engefire",
                    completed: false
                }
            ];
            saveData();
            renderEvents();
        }
    </script>
</body>
</html>
